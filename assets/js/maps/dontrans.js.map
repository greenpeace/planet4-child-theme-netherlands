{"version":3,"sources":["dontrans.js"],"names":["$","document","ready","URLSearchParams","location","search","substring","donation_transaction","params","get","ajax","type","window","ajaxurl","url","data","response","request","success","nonce","transaction","method","JSON","parse","gtm_products","sku","frequency","category","price","amount","quantity","dataLayer","push","event","transactionId","transactionAffiliation","transactionTotal","transactionTax","transactionShipping","transactionPaymentType","transactionCurrency","transactionPromoCode","transactionProducts","virtualPageviewStep","virtuelPageviewName","error","console","log"],"mappings":"aACAA,EAAEC,UAAUC,MAAM,WAAhBD,IAAAA,EAAUC,IAAMC,gBAAWF,SAAAG,SAAAC,OAAAC,UAAA,IAI3B,GAHiBH,EAAgBF,IAAAA,aAGR,CAAzB,IAAGM,EAAsBC,EAAAC,IAAA,aAGvBT,EAAEU,KAAK,CAALA,KAAK,OACLC,IAASC,OADJ,QAAAC,QAELC,KAASF,CAAAA,OAAM,cACfG,QAAS,SAAAC,GAHJ,IAAAC,EAAA,CAILC,OAAS,eAEPC,MAAWH,EAAGD,KAAAI,MACZC,YAAWb,GADCP,EAAdU,KAAA,CAMEA,OAAK,OACLW,IAAAA,OAAQ,QADHR,QAELC,KAAKF,EACLG,QAAME,SAHDD,GAILE,IAAAA,EAASI,KAAAC,MAAAP,EAASA,KAAUD,MAC1B,GAAsBC,oBAAXM,UAAyBP,CAElC,IAAAS,EAAA,GAEAA,EAAIA,KAAY,CAEhBA,KAAAA,aACEC,IAAAV,EAAQW,UACRC,SAAYD,UACZE,MAAAb,EAAYc,OACZC,SAASf,IASXgB,UAAUC,KAAK,CACbC,MAAS,aACTC,cAAiB3B,EACjB4B,uBAA0BpB,EAAKW,UAC/BU,iBAAoBrB,EAAKc,OACzBQ,eAAkB,GAClBC,oBAAuB,GACvBC,uBAA0B,QAC1BC,oBAAuB,MACvBC,qBAAwB,GACxBC,oBAAuBlB,IAIvBO,UAAAC,KAAS,CACTC,MAAA,yBAAkCU,oBAAA,UAClCC,oBAAuB,cAK7BC,MAAO,WACLC,QAAQC,IAAI","file":"../dontrans.js","sourcesContent":["\n$(document).ready(function() {\n  let params = new URLSearchParams(document.location.search.substring(1));\n  let donation_transaction = params.has('don_trans');\n\n  if(donation_transaction) {\n    let donation_transaction = params.get(\"don_trans\");\n\n    $.ajax({\n      type:    'POST',\n      url:     window['p4_vars'].ajaxurl,\n      data:    {'action' : 'request_id'},\n      success: function(response) {\n\n        let request = {\n          'action' : 'get_donation',\n          'nonce'  : response.data.nonce,\n          'transaction' : donation_transaction\n        };\n\n        $.ajax({\n          method: 'POST',\n          url: window['p4_vars'].ajaxurl,\n          data: request,\n          success: function(response) {\n            let data = JSON.parse(response.data.data);\n            if (typeof dataLayer !== 'undefined') {\n              // Google Tag Manager E-commerce */\n              // Build product array\n              let gtm_products = [];\n\n              gtm_products.push({\n                'name': 'machtiging',\n                'sku': data.frequency,\n                'category': 'donatie',\n                'price': data.amount,\n                'quantity': 1\n              });\n              // Optional repeat for each additional product to fill gtm_products array\n\n\n              /** Build an event send to the Datalayer, which needs to trigger the E-commerce transaction in the GTM backend\n               *  Additional datalayer items are send to the datalayer and processed by the GTM as an transaction\n               */\n              dataLayer.push({\n                'event': 'trackTrans',\n                'transactionId': donation_transaction,\n                'transactionAffiliation': data.frequency,\n                'transactionTotal': data.amount,\n                'transactionTax': '',\n                'transactionShipping': '',\n                'transactionPaymentType': 'ideal',\n                'transactionCurrency': 'EUR',\n                'transactionPromoCode': '',\n                'transactionProducts': gtm_products\n              });\n\n              dataLayer.push({\n                'event': 'virtualPageViewDonatie',\n                'virtualPageviewStep': 'Bedankt', //Vul hier de stap in. E.g. Stap 1, Stap 2, Stap 3, Bedankt\n                'virtuelPageviewName': 'Bedankt' // Vul hier de stapnaam in. E.g. Donatie, gegevens, adres, Bedankt\n              });\n\n            }\n          },\n          error: function() {\n            console.log('Nooo....');\n          }\n        });\n      }\n    });\n  }\n});\n"]}