{"version":3,"sources":["dontrans.js"],"names":["jQuery","document","ready","params","location","search","substring","URLSearchParams","donation_transaction","get","ajaxurl","type","url","data","response","request","success","nonce","transaction","ajax","method","JSON","parse","gtm_products","sku","frequency","category","price","amount","quantity","dataLayer","push","event","transactionId","transactionAffiliation","transactionTotal","transactionTax","transactionShipping","transactionPaymentType","transactionCurrency","transactionPromoCode","transactionProducts","virtualPageviewStep","virtuelPageviewName","error","console","log"],"mappings":"aACAA,OAAOC,UAAUC,MAAM,WAAvBF,IAAMG,EAAA,IAAWD,gBAAiBD,SAAAG,SAAAC,OAAAC,UAAA,IAIhC,GAHiBC,EAAgBN,IAAAA,aAGR,CAAzB,IAAGO,EAAsBL,EAAAM,IAAA,aACnBD,EAAAA,OAAAA,UAA6BE,QACjCV,OAAIU,KAAO,CAEXV,KAAA,OACEW,IAASD,EACTE,KAASF,CAAAA,OAFC,cAGVG,QAAS,SAAAC,GAHC,IAAAC,EAAA,CAIVC,OAAS,eAEPC,MAAWH,EAAGD,KAAAI,MACZC,YAAWV,GADCR,OAAdmB,KAAA,CAMAnB,OAAOmB,OACLC,IAAAA,EACAR,KAAKF,EACLG,QAAME,SAHID,GAIVE,IAAAA,EAASK,KAAAC,MAAAR,EAASA,KAAUD,MAC1B,GAAsBC,oBAAXO,UAAyBR,CAElC,IAAAU,EAAA,GAEAA,EAAIA,KAAY,CAEhBA,KAAAA,aACEC,IAAAX,EAAQY,UACRC,SAAYD,UACZE,MAAAd,EAAYe,OACZC,SAAShB,IASXiB,UAAUC,KAAK,CACbC,MAAS,aACTC,cAAiBzB,EACjB0B,uBAA0BrB,EAAKY,UAC/BU,iBAAoBtB,EAAKe,OACzBQ,eAAkB,GAClBC,oBAAuB,GACvBC,uBAA0B,QAC1BC,oBAAuB,MACvBC,qBAAwB,GACxBC,oBAAuBlB,IAIvBO,UAAAC,KAAS,CACTC,MAAA,yBAAkCU,oBAAA,UAClCC,oBAAuB,cAK7BC,MAAO,WACLC,QAAQC,IAAI","file":"../dontrans.js","sourcesContent":["\njQuery(document).ready(function() {\n  let params = new URLSearchParams(document.location.search.substring(1));\n  let donation_transaction = params.has('don_trans');\n\n  if(donation_transaction) {\n    let donation_transaction = params.get(\"don_trans\");\n    let ajaxurl = window['p4nl_vars'].ajaxurl;\n\n    jQuery.ajax({\n      type:    'POST',\n      url:     ajaxurl,\n      data:    {'action' : 'request_id'},\n      success: function(response) {\n\n        let request = {\n          'action' : 'get_donation',\n          'nonce'  : response.data.nonce,\n          'transaction' : donation_transaction\n        };\n\n        jQuery.ajax({\n          method: 'POST',\n          url: ajaxurl,\n          data: request,\n          success: function(response) {\n            let data = JSON.parse(response.data.data);\n            if (typeof dataLayer !== 'undefined') {\n              // Google Tag Manager E-commerce */\n              // Build product array\n              let gtm_products = [];\n\n              gtm_products.push({\n                'name': 'machtiging',\n                'sku': data.frequency,\n                'category': 'donatie',\n                'price': data.amount,\n                'quantity': 1\n              });\n              // Optional repeat for each additional product to fill gtm_products array\n\n\n              /** Build an event send to the Datalayer, which needs to trigger the E-commerce transaction in the GTM backend\n               *  Additional datalayer items are send to the datalayer and processed by the GTM as an transaction\n               */\n              dataLayer.push({\n                'event': 'trackTrans',\n                'transactionId': donation_transaction,\n                'transactionAffiliation': data.frequency,\n                'transactionTotal': data.amount,\n                'transactionTax': '',\n                'transactionShipping': '',\n                'transactionPaymentType': 'ideal',\n                'transactionCurrency': 'EUR',\n                'transactionPromoCode': '',\n                'transactionProducts': gtm_products\n              });\n\n              dataLayer.push({\n                'event': 'virtualPageViewDonatie',\n                'virtualPageviewStep': 'Bedankt', //Vul hier de stap in. E.g. Stap 1, Stap 2, Stap 3, Bedankt\n                'virtuelPageviewName': 'Bedankt' // Vul hier de stapnaam in. E.g. Donatie, gegevens, adres, Bedankt\n              });\n\n            }\n          },\n          error: function() {\n            console.log('Nooo....');\n          }\n        });\n      }\n    });\n  }\n});\n"]}